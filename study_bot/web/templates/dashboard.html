<!DOCTYPE html>
<html lang="ar" dir="rtl" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لوحة تحكم بوت الدراسة والتحفيز</title>
    <!-- تضمين Bootstrap CSS -->
    <link href="https://cdn.replit.com/agent/bootstrap-agent-dark-theme.min.css" rel="stylesheet">
    <!-- تضمين الخطوط العربية -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Tajawal:400,500,700&display=swap">
    <style>
        body {
            font-family: 'Tajawal', Arial, sans-serif;
        }
        .card {
            transition: transform 0.3s;
        }
        .card:hover {
            transform: translateY(-5px);
        }
        .stats-card {
            background-color: var(--bs-dark);
            border-left: 4px solid var(--bs-info);
        }
    </style>
</head>
<body>
    <div class="container-fluid py-4">
        <div class="row mb-4">
            <div class="col-12">
                <h2 class="mb-4 text-center">لوحة تحكم بوت الدراسة والتحفيز</h2>
            </div>
        </div>

        <!-- بطاقات الإحصائيات -->
        <div class="row mb-5">
            <div class="col-12 col-md-6 col-lg-3 mb-4">
                <div class="card stats-card">
                    <div class="card-body">
                        <h5 class="card-title">المستخدمين</h5>
                        <h2 class="display-4 fw-bold">{{ stats.total_users }}</h2>
                        <p class="card-text">إجمالي المستخدمين النشطين</p>
                    </div>
                </div>
            </div>
            <div class="col-12 col-md-6 col-lg-3 mb-4">
                <div class="card stats-card">
                    <div class="card-body">
                        <h5 class="card-title">المجموعات</h5>
                        <h2 class="display-4 fw-bold">{{ stats.total_groups }}</h2>
                        <p class="card-text">إجمالي المجموعات النشطة</p>
                    </div>
                </div>
            </div>
            <div class="col-12 col-md-6 col-lg-3 mb-4">
                <div class="card stats-card">
                    <div class="card-body">
                        <h5 class="card-title">المعسكرات</h5>
                        <h2 class="display-4 fw-bold">{{ stats.active_camps }}</h2>
                        <p class="card-text">المعسكرات الدراسية النشطة</p>
                    </div>
                </div>
            </div>
            <div class="col-12 col-md-6 col-lg-3 mb-4">
                <div class="card stats-card">
                    <div class="card-body">
                        <h5 class="card-title">الرسائل</h5>
                        <h2 class="display-4 fw-bold">{{ stats.messages_sent }}</h2>
                        <p class="card-text">إجمالي الرسائل المرسلة</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- القوائم الرئيسية -->
        <div class="row mb-4">
            <div class="col-12 col-md-6 col-lg-4 mb-4">
                <div class="card h-100">
                    <div class="card-header">
                        <h5 class="card-title mb-0">إدارة المجموعات</h5>
                    </div>
                    <div class="card-body">
                        <p class="card-text">إدارة المجموعات النشطة وتعديل إعداداتها وجداولها الدراسية.</p>
                        <a href="/groups" class="btn btn-primary">عرض المجموعات</a>
                    </div>
                </div>
            </div>
            <div class="col-12 col-md-6 col-lg-4 mb-4">
                <div class="card h-100">
                    <div class="card-header">
                        <h5 class="card-title mb-0">إدارة المستخدمين</h5>
                    </div>
                    <div class="card-body">
                        <p class="card-text">عرض قائمة المستخدمين النشطين ومعلوماتهم وإحصائياتهم.</p>
                        <a href="/users" class="btn btn-primary">عرض المستخدمين</a>
                    </div>
                </div>
            </div>
            <div class="col-12 col-md-6 col-lg-4 mb-4">
                <div class="card h-100">
                    <div class="card-header">
                        <h5 class="card-title mb-0">إدارة المعسكرات</h5>
                    </div>
                    <div class="card-body">
                        <p class="card-text">عرض المعسكرات الدراسية النشطة وإدارة مهامها ومشاركيها.</p>
                        <a href="/camps" class="btn btn-primary">عرض المعسكرات</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- أدوات متقدمة -->
        <div class="row mb-4">
            <div class="col-12 col-md-6 mb-4">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title mb-0">إرسال رسالة جماعية</h5>
                    </div>
                    <div class="card-body">
                        <p class="card-text">إرسال رسالة جماعية لجميع المستخدمين النشطين في البوت.</p>
                        <a href="/send_broadcast" class="btn btn-info">إرسال رسالة</a>
                    </div>
                </div>
            </div>
            <div class="col-12 col-md-6 mb-4">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title mb-0">حالة النظام</h5>
                    </div>
                    <div class="card-body">
                        <p class="card-text">عرض حالة النظام والمجدولات النشطة ومعلومات التشغيل.</p>
                        <button class="btn btn-info" id="refreshStatsBtn">تحديث الإحصائيات</button>
                    </div>
                </div>
            </div>
        </div>

        <footer class="text-center mt-5">
            <p>&copy; 2025 - بوت الدراسة والتحفيز | جميع الحقوق محفوظة</p>
        </footer>
    </div>

    <!-- تضمين Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // تحديث الإحصائيات
        document.getElementById('refreshStatsBtn').addEventListener('click', function() {
            fetch('/api/stats')
                .then(response => response.json())
                .then(data => {
                    document.querySelector('.stats-card:nth-child(1) .display-4').textContent = data.total_users;
                    document.querySelector('.stats-card:nth-child(2) .display-4').textContent = data.total_groups;
                    document.querySelector('.stats-card:nth-child(3) .display-4').textContent = data.active_camps;
                    document.querySelector('.stats-card:nth-child(4) .display-4').textContent = data.messages_sent;
                })
                .catch(error => console.error('Error:', error));
        });
    </script>
</body>
</html>