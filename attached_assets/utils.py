#!/usr/bin/env python3
"""
ูุญุฏุฉ ุงููุณุงุนุฏุฉ
ุชุญุชูู ุนูู ูุธุงุฆู ูุณุงุนุฏุฉ ููุจูุช ููุงุฌูุฉ ุงูููุจ
"""

import os
import sys
from datetime import datetime, timedelta
import json
import random

def get_morning_schedule_text(tracker):
    """ุงูุญุตูู ุนูู ูุต ุงูุฌุฏูู ุงูุตุจุงุญู"""
    # ุงูุชุญูู ูู ุงูุชูุงู ุงูููุงู ูุฅุถุงูุฉ ุฑููุฒ ูุนุฑุถูุง
    joined_status = "โ" if tracker.joined else "โฌ๏ธ"
    prayer_1_status = "โ" if tracker.prayer_1 else "โฌ๏ธ"
    meal_1_status = "โ" if tracker.meal_1 else "โฌ๏ธ"
    study_1_status = "โ" if tracker.study_1 else "โฌ๏ธ"
    prayer_2_status = "โ" if tracker.prayer_2 else "โฌ๏ธ"
    study_2_status = "โ" if tracker.study_2 else "โฌ๏ธ"
    return_status = "โ" if tracker.return_after_break else "โฌ๏ธ"
    prayer_3_status = "โ" if tracker.prayer_3 else "โฌ๏ธ"
    study_3_status = "โ" if tracker.study_3 else "โฌ๏ธ"
    prayer_4_status = "โ" if tracker.prayer_4 else "โฌ๏ธ"
    prayer_5_status = "โ" if tracker.prayer_5 else "โฌ๏ธ"
    evaluation_status = "โ" if tracker.evaluation else "โฌ๏ธ"
    
    # ุจูุงุก ูุต ุงูุฌุฏูู
    schedule_text = f"""
<b>๐ ุงูุฌุฏูู ุงูุตุจุงุญู - {tracker.date.strftime('%Y-%m-%d')}</b>

<b>ุงูุตุจุงุญ:</b>
{joined_status} ุชุณุฌูู ุงูุญุถูุฑ
{prayer_1_status} ุตูุงุฉ ุงููุฌุฑ (5:00 ุต)
{meal_1_status} ุงูุฅูุทุงุฑ (7:00 ุต)
{study_1_status} ุจุฏุก ุงููุฐุงูุฑุฉ (8:00 ุต)

<b>ุงูุธูุฑ:</b>
{prayer_2_status} ุตูุงุฉ ุงูุธูุฑ (12:00 ู)
{study_2_status} ุงููุฐุงูุฑุฉ ุจุนุฏ ุงูุธูุฑ (1:00 ู)
{return_status} ุงูุนูุฏุฉ ุจุนุฏ ุงูุฑุงุญุฉ (2:30 ู)

<b>ุงูุนุตุฑ ูุงููุณุงุก:</b>
{prayer_3_status} ุตูุงุฉ ุงูุนุตุฑ (3:30 ู)
{study_3_status} ุงููุฑุงุฌุนุฉ (4:00 ู)
{prayer_4_status} ุตูุงุฉ ุงููุบุฑุจ (6:30 ู)
{prayer_5_status} ุตูุงุฉ ุงูุนุดุงุก (8:00 ู)

<b>ููุงูุฉ ุงูููู:</b>
{evaluation_status} ุชูููู ุงูููู (10:00 ู)

<b>ุญุงูุฉ ุงูุฌุฏูู:</b> {get_completion_status(tracker)}
"""
    
    return schedule_text

def get_evening_schedule_text(tracker):
    """ุงูุญุตูู ุนูู ูุต ุงูุฌุฏูู ุงููุณุงุฆู"""
    # ุงูุชุญูู ูู ุงูุชูุงู ุงูููุงู ูุฅุถุงูุฉ ุฑููุฒ ูุนุฑุถูุง
    joined_status = "โ" if tracker.joined else "โฌ๏ธ"
    study_1_status = "โ" if tracker.study_1 else "โฌ๏ธ"
    prayer_1_status = "โ" if tracker.prayer_1 else "โฌ๏ธ"
    study_2_status = "โ" if tracker.study_2 else "โฌ๏ธ"
    prayer_2_status = "โ" if tracker.prayer_2 else "โฌ๏ธ"
    study_3_status = "โ" if tracker.study_3 else "โฌ๏ธ"
    evaluation_status = "โ" if tracker.evaluation else "โฌ๏ธ"
    early_sleep_status = "โ" if tracker.early_sleep else "โฌ๏ธ"
    
    # ุจูุงุก ูุต ุงูุฌุฏูู
    schedule_text = f"""
<b>๐ ุงูุฌุฏูู ุงููุณุงุฆู - {tracker.date.strftime('%Y-%m-%d')}</b>

<b>ูุง ุจุนุฏ ุงูุธูุฑ:</b>
{joined_status} ุชุณุฌูู ุงูุญุถูุฑ
{study_1_status} ุจุฏุก ุงููุฑุงุฌุนุฉ (3:00 ู)

<b>ุงููุณุงุก:</b>
{prayer_1_status} ุตูุงุฉ ุงููุบุฑุจ (6:30 ู)
{study_2_status} ุจุฏุก ูุงุฌุจ/ุชุฏุฑูุจ (7:00 ู)
{prayer_2_status} ุตูุงุฉ ุงูุนุดุงุก (8:00 ู)
{study_3_status} ุงูุญูุธ/ุงููุฑุงุกุฉ ุงูุฎูููุฉ (8:30 ู)

<b>ููุงูุฉ ุงูููู:</b>
{evaluation_status} ุชูููู ุงูููู (10:00 ู)
{early_sleep_status} ุงูููู ุงููุจูุฑ (11:00 ู)

<b>ุญุงูุฉ ุงูุฌุฏูู:</b> {get_completion_status(tracker)}
"""
    
    return schedule_text

def get_custom_schedule_text(tracker, custom_schedule):
    """ุงูุญุตูู ุนูู ูุต ุงูุฌุฏูู ุงููุฎุตุต"""
    # ุจูุงุก ูุต ุงูุฌุฏูู ุงููุฎุตุต
    schedule_text = f"""
<b>โ๏ธ ุงูุฌุฏูู ุงููุฎุตุต - {tracker.date.strftime('%Y-%m-%d')}</b>

"""
    
    # ุฅุถุงูุฉ ุงูููุงู ุงููุฎุตุตุฉ
    for task_key, task_info in custom_schedule.items():
        task_name = task_info.get('name', task_key)
        task_time = task_info.get('time', '')
        
        # ุงูุชุญูู ูู ุญุงูุฉ ุงููููุฉ
        task_status = "โ" if getattr(tracker, task_key, False) else "โฌ๏ธ"
        
        # ุจูุงุก ุณุทุฑ ุงููููุฉ
        task_line = f"{task_status} {task_name}"
        if task_time:
            task_line += f" ({task_time})"
        
        schedule_text += task_line + "\n"
    
    # ุฅุถุงูุฉ ุญุงูุฉ ุงูุฌุฏูู
    schedule_text += f"\n<b>ุญุงูุฉ ุงูุฌุฏูู:</b> {get_completion_status(tracker)}"
    
    return schedule_text

def get_completion_status(tracker):
    """ุงูุญุตูู ุนูู ุญุงูุฉ ุฅููุงู ุงูุฌุฏูู"""
    if tracker.completed:
        return "โ ููุชูู"
    
    # ุญุณุงุจ ูุณุจุฉ ุงูุฅููุงู
    completed_count = 0
    total_count = 0
    
    if tracker.schedule_type == 'morning':
        tasks = [
            'joined', 'prayer_1', 'meal_1', 'study_1', 
            'prayer_2', 'study_2', 'return_after_break',
            'prayer_3', 'study_3', 'prayer_4', 'prayer_5', 
            'evaluation'
        ]
    elif tracker.schedule_type == 'evening':
        tasks = [
            'joined', 'study_1', 'prayer_1', 'study_2',
            'prayer_2', 'study_3', 'evaluation', 'early_sleep'
        ]
    else:
        # ููุฌุฏุงูู ุงููุฎุตุตุฉุ ูุนุชุจุฑ ุงูููุงู ุงูุฃุณุงุณูุฉ
        tasks = [
            'joined', 'study_1', 'evaluation'
        ]
    
    # ุญุณุงุจ ุนุฏุฏ ุงูููุงู ุงูููุชููุฉ
    for task_name in tasks:
        total_count += 1
        if getattr(tracker, task_name, False):
            completed_count += 1
    
    # ุญุณุงุจ ุงููุณุจุฉ ุงููุฆููุฉ ููุฅููุงู
    completion_percentage = int((completed_count / total_count) * 100) if total_count > 0 else 0
    
    # ุจูุงุก ุดุฑูุท ุงูุชูุฏู
    progress_bar = generate_progress_bar(completed_count, total_count, 10)
    
    return f"{progress_bar} {completion_percentage}%"

def generate_progress_bar(current, total, length=10):
    """ุฅูุดุงุก ุดุฑูุท ุชูุฏู ูุตู"""
    progress = min(1, current / total) if total > 0 else 0
    filled_length = int(length * progress)
    
    bar = 'โ' * filled_length + 'โ' * (length - filled_length)
    
    return bar

def get_motivational_messages(category='general'):
    """ุงูุญุตูู ุนูู ูุงุฆูุฉ ุจุงูุฑุณุงุฆู ุงูุชุญููุฒูุฉ"""
    # ูุงุฆูุฉ ุงูุฑุณุงุฆู ุงูุชุญููุฒูุฉ ุญุณุจ ุงููุฆุฉ
    messages = {
        'general': [
            "ูุง ุชุคุฌู ุนูู ุงูููู ุฅูู ุงูุบุฏ. ุงุจุฏุฃ ุงูุขู! ๐ช",
            "ุงูุนูู ููุฑ ูุงูุฌูู ุธูุงูุ ูุงุตู ุงูุชุนูู ูุชููุฑ ุญูุงุชู โจ",
            "ุงูุฅุตุฑุงุฑ ูุงููุซุงุจุฑุฉ ููุง ููุชุงุญ ุงููุฌุงุญ. ุงุณุชูุฑ! ๐",
            "ูู ุฎุทูุฉ ุตุบูุฑุฉ ุชูุฑุจู ูู ุฃูุฏุงูู ุงููุจูุฑุฉ ๐ฏ",
            "ุงููุฐุงูุฑุฉ ุงูููุชุธูุฉ ุฃูุถู ูู ุงููุฐุงูุฑุฉ ุงูููุซูุฉ ูุจู ุงูุงุฎุชุจุงุฑ ๐",
            "ูุง ุชูุงุฑู ุชูุฏูู ุจุชูุฏู ุงูุขุฎุฑููุ ุฑูุฒ ุนูู ุชุญุณูู ููุณู ๐ฑ",
            "ุงููุนุฑูุฉ ููุฒ ูุง ููููุ ูุงูุชุนูู ุงุณุชุซูุงุฑ ุฏุงุฆู โก",
            "ุงูุนูู ุงูุณููู ูู ุงูุฌุณู ุงูุณููู. ุชุฐูุฑ ุฃู ุชุฃุฎุฐ ุงุณุชุฑุงุญุฉ ูุชูุงุฑุณ ุงูุฑูุงุถุฉ ๐โโ๏ธ",
            "ูุง ุชุฎู ูู ุงููุดูุ ููู ุฃูู ุฎุทูุงุช ุงููุฌุงุญ ๐งโโ๏ธ",
            "ุชุฐูุฑ ุฏุงุฆููุง ุฃู ุงูุตุนูุจุงุช ูู ุงูุชู ุชุตูุน ุงูุนุธูุงุก ๐"
        ],
        'morning': [
            "ุตุจุงุญ ุงูุฎูุฑ! ููู ุฌุฏูุฏ ููุฑุตุฉ ุฌุฏูุฏุฉ ููุชุนูู ูุงูุฅูุฌุงุฒ โ๏ธ",
            "ุจุฏุงูุฉ ูููุฉ ุชุนูู ููููุง ูุงุฌุญูุง. ุงุจุฏุฃ ุตุจุงุญู ุจุงููุฐุงูุฑุฉ ๐",
            "ุตุจุงุญ ุงููุดุงุท! ุงุณุชุบู ุทุงูุชู ุงูุตุจุงุญูุฉ ูู ุฃุตุนุจ ุงูููุงู ๐",
            "ูุง ุชูุนูู ูู ุงูุตุจุงุญ ูุญุฏุฏ ูุณุงุฑ ูููู. ุงุฌุนูู ูููุฆูุง ุจุงูุฅูุชุงุฌูุฉ ๐",
            "ุงูุตุจุงุญ ุงูุจุงูุฑ ูู ุฃูุถู ููุช ููุชุฑููุฒ ูุงูุฅุจุฏุงุน. ุงุณุชุซูุฑู ุฌูุฏูุง โฐ",
            "ูุน ูู ุดุฑูู ุดูุณุ ูุฑุตุฉ ุฌุฏูุฏุฉ ููุชููู โ๏ธ",
            "ุงูุทุงูุจ ุงููุงุฌุญ ูุจุฏุฃ ูููู ูุจูุฑูุง ููุณุชุนุฏูุง ููุชุญุฏูุงุช ๐",
            "ุจุฏุงูุงุช ุงูุตุจุงุญ ูู ุฃููู ุฃููุงุช ุงูุชูููุฑ. ุงุณุชุบููุง ูู ุงููุฐุงูุฑุฉ ๐"
        ],
        'evening': [
            "ุงููุณุงุก ููุช ูุซุงูู ูููุฑุงุฌุนุฉ ูุชุซุจูุช ุงููุนูููุงุช ๐",
            "ูุซูุฑ ูู ุงูุนููุงุก ููุถููู ุงููุฐุงูุฑุฉ ูู ุงููุณุงุก. ุงุณุชูุฏ ูู ูุฐุง ุงูููุช ุงููุงุฏุฆ ๐",
            "ูุจู ุงููููุ ุฑุงุฌุน ูุง ุชุนููุชู ุงูููู ูุชุซุจูุช ุงููุนูููุงุช ูู ุฐุงูุฑุชู ๐ง",
            "ุงููุณุงุก ูุฑุตุฉ ููุชุฎุทูุท ููููู ุงููุงุฏู ูุงุณุชููุงู ูุง ุชุจูู ูู ููุงู ๐",
            "ุงุณุชุบู ูุฏูุก ุงูููู ูู ุงููุฑุงุกุฉ ูุงูุญูุธ ๐",
            "ูุง ุชูุณู ุฃุฎุฐ ูุณุท ูุงูู ูู ุงููููุ ููู ุฃุณุงุณ ูููุฌุงุญ ูู ุงูููู ุงูุชุงูู ๐ค",
            "ูู ุงููุณุงุกุ ุงุชุฑู ุงูููู ุฌุงูุจูุง ูุงุณุชูุชุน ุจุฅูุฌุงุฒุงุชู ุงูููููุฉ ๐",
            "ุงููุซุงุจุฑุฉ ูู ุงููุณุงุก ุชุคุชู ุซูุงุฑูุง ูู ุงูุตุจุงุญ โจ"
        ],
        'study': [
            "ุฑูุฒ ุนูู ุงูููู ูููุณ ุงูุญูุธ. ุงููุนุฑูุฉ ุงูุญููููุฉ ุชุฃุชู ูู ุงูููู ุงูุนููู ๐งฉ",
            "ุงูุชูุฑุงุฑ ูู ููุชุงุญ ุงูุญูุธ. ูุฑุฑ ุงููุนูููุงุช ุงููููุฉ ูุชุซุจูุชูุง ๐",
            "ูุณูู ููุชู ุจูู ุงูููุงุฏ ุงููุฎุชููุฉ ููุญูุงุธ ุนูู ุชุฑููุฒู ููุนุงููุชู ๐",
            "ุงุณุชุฎุฏู ุชูููุฉ ุจูููุฏูุฑู: 25 ุฏูููุฉ ุฏุฑุงุณุฉุ 5 ุฏูุงุฆู ุฑุงุญุฉ โฑ๏ธ",
            "ุงุดุฑุญ ูุง ุชุนููุชู ูุดุฎุต ุขุฎุฑุ ููุฐุง ุฃูุถู ุงุฎุชุจุงุฑ ููููู ๐ฃ๏ธ",
            "ุงูููุฎุตุงุช ูุงูุฎุฑุงุฆุท ุงูุฐูููุฉ ุชุณุงุนุฏ ูู ุชูุธูู ุงููุนูููุงุช ูุชุฐูุฑูุง ๐",
            "ุงุจุญุซ ุนู ุชุทุจููุงุช ุนูููุฉ ูููุนูููุงุช ุงูุชู ุชุชุนูููุงุ ููุฐุง ูุนุฒุฒ ูููู ๐ก",
            "ุชุนูู ูู ุฃุฎุทุงุฆู ูุฃุณุฆูุชู ุงูุฎุงุทุฆุฉุ ููู ูุฑุต ุฐูุจูุฉ ููุชุญุณู ๐",
            "ูุง ุชุชุฑุฏุฏ ูู ุทูุจ ุงููุณุงุนุฏุฉ ุนูุฏูุง ุชุญุชุงุฌูุง. ุงูุชุนูู ุฑุญูุฉ ุฌูุงุนูุฉ ๐ค",
            "ุงูุฑุฃ ุจุตูุช ูุฑุชูุน ุนูุฏ ุงููุฐุงูุฑุฉุ ููุฐุง ูุณุงุนุฏ ูู ุงูุชุฑููุฒ ูุงูุชุฐูุฑ ๐"
        ]
    }
    
    # ุงุณุชุฎุฏุงู ุงููุฆุฉ ุงููุทููุจุฉ ุฃู ุงููุฆุฉ ุงูุนุงูุฉ ูุจุฏูู
    category_messages = messages.get(category, messages['general'])
    
    return category_messages

def get_random_motivational_message(category='general'):
    """ุงูุญุตูู ุนูู ุฑุณุงูุฉ ุชุญููุฒูุฉ ุนุดูุงุฆูุฉ"""
    messages = get_motivational_messages(category)
    return random.choice(messages)
